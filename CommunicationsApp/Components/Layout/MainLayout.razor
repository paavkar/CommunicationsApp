@inherits LayoutComponentBase

@inject ChatHubService ChatHubService

<PageTitle>CA</PageTitle>

    <FluentHeader Style="position: sticky; top: 0; z-index: 1;">
        CommunicationsApp
    </FluentHeader>
    <FluentStack Orientation="Orientation.Horizontal" Width="100%" Style="height: calc(100vh - 50px); overflow: hidden;">
        <div class="sidebar">
            <NavMenu />
        </div>
        <FluentBodyContent Class="body-content">
            <div class="content">
                @Body
            </div>
        </FluentBodyContent>
    </FluentStack>

<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">🗙</span>
</div>

<FluentToastProvider Position="ToastPosition.TopRight" RemoveToastsOnNavigation="false" @rendermode=InteractiveServer />
<FluentDialogProvider @rendermode=InteractiveServer />
<FluentTooltipProvider @rendermode=InteractiveServer />
<FluentMessageBarProvider @rendermode=InteractiveServer />
<FluentMenuProvider @rendermode=InteractiveServer />

@code {
    protected override void OnInitialized()
    {
        ChatHubService.DataReady += OnDataReady;
    }

    private void OnDataReady(string contextId, string dataType)
    {
        Console.WriteLine($"MainLayout: {dataType}");
    }

    public void Dispose()
    {
        ChatHubService.DataReady -= OnDataReady;
    }
}